L题，回文子块。双指针结束。赛时模拟样例时，没有那种块块的，导致一半时间都是在想假算法。寄（

```cpp
class strHash {
	typedef unsigned long long ULL;
public:
	strHash(const string& s) {
		this->str = "^" + s;
		dispose();
	}
	ULL get(int l, int r) {
		return h[r] - h[l - 1] * p[r - l + 1];
	}
private:
	void dispose() {
		len = str.size();
		h.assign(len + 1, 0); p.assign(len + 1, 0);
		h[0] = p[0] = 1;
		for(int i = 1; i <= len; ++i) {
			h[i] = h[i-1] * P + str[i];
			p[i] = p[i - 1] * P;
		}
	}

	const ULL P = 11451;
	string str;
	ULL len;
	vector<ULL> h,p;
};
void inpfile();
void solve() {
    string str; cin>>str;
    strHash has(str);
    LL cnt = 0;
    int n = str.size();
    for(int i = 1; i <= n; ++i) {
        int r1 = i, l2 = i+1;
        for(int l1 = i, r2 = i+1; l1 >= 1 && r2 <= n; --l1, ++r2) {
            if(has.get(l1, r1) == has.get(l2,r2)) cnt++, r1 = l1-1, l2 = r2+1;
        }
    }
    cout<<cnt<<endl;
}
```

E，类lca bfs。

```cpp
void solve() {
    int n,m; cin>>n>>m;
    vector<int> fa(n + 1), cnt(n + 1, -1);
    vector<vector<int>> g(n + 1);
    for(int i = 2; i <= n; ++i) {
        int p; cin>>p;
        g[p].push_back(i);
        g[i].push_back(p);
    }
    auto dfs = [&](auto &&dfs, int u, int fu) -> void {
        for(auto y: g[u]) {
            if(y == fu) continue;
            fa[y] = u;
            dfs(dfs, y,u);
        }
    };
    cnt[1] = 0;
    dfs(dfs, 1, -1);
    vector<vector<array<int,2>>> mip(n + 1); // u v
    queue<array<int,3>> q; // u,v,cnt
    for(int i = 0; i < m; ++i) {
        int u,v; cin>>u>>v;
        mip[u].push_back({u,v});
        mip[v].push_back({v,u});
        if(u == 1 || v == 1) q.push({u,v,0});
    }
    while(q.size()) {
        auto tmp = q.front(); q.pop();
        int u = tmp[0], ct = tmp[2] + 1;
        while(cnt[u] == -1) {
            cnt[u] = ct;
            if(mip[u].size()) {
                for(auto t: mip[u]) {
                    q.push({t[0], t[1], ct});
                }
            }
            u = fa[u];
        }
        u = tmp[1];
        while(cnt[u] == -1) {
            cnt[u] = ct;
            if(mip[u].size()) {
                for(auto t: mip[u]) {
                    q.push({t[0], t[1], ct});
                }
            }
            u = fa[u];
        }
    }
    for(int i = 2; i <= n; ++i) cout<<cnt[i]<<" ";
}
```

